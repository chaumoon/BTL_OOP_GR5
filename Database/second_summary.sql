create database coachticketsales;

create table TuyenDuong(
maTD int not null primary key,
diemDi varchar(100) not null,
diemDen varchar(100) not null
);
insert into TuyenDuong (maTD, diemDi, diemDen) values
(1, 'HaNoi', 'HaiPhong'),
(2, 'HaNoi', 'QuangNinh'),
(3, 'HaNoi', 'NgheAn'),
(4, 'HaNoi', 'LaoCai'),
(5, 'HaNoi', 'ThanhHoa'),
(6, 'HaiPhong', 'HaNoi'),
(7, 'QuangNinh', 'HaNoi'),
(8, 'NgheAn', 'HaNoi'),
(9, 'LaoCai', 'HaNoi'),
(10, 'ThanhHoa', 'HaNoi');


create table Xe(
maXe varchar(100) not null primary key,
bienSo varchar(100) not null,
loaiXe varchar(100) not null,
tongCho int not null
);
insert into Xe (maXe, bienSo, loaiXe, tongCho) values
('X001', '29B', 'ghế ngồi', 30),
('X002', '34B', 'ghế ngồi', 30),
('X003', '30B', 'ghế ngồi', 30),
('X004', '35B', 'ghế ngồi', 30),
('X005', '32B', 'ghế ngồi', 30),
('X006', '36B', 'ghế ngồi', 30),
('X007', '32B', 'ghế ngồi', 30),
('X008', '37B', 'ghế ngồi', 30),
('X009', '33B', 'ghế ngồi', 30),
('X010', '38B', 'ghế ngồi', 30);

create table KhungGio(
maKG int not null primary key,
gioDi time not null,
gioDen time not null,
maTD int not null,
foreign key(maTD) references TuyenDuong(maTD)
);
insert into KhungGio (maKG, gioDi, gioDen, maTD) values
(1, '05:00:00', '06:30:00', 1), -- HN - HP
(2, '06:00:00', '07:30:00', 1),
(3, '09:00:00', '10:30:00', 1),
(4, '10:00:00', '11:30:00', 1),
(5, '15:00:00', '16:30:00', 1),
(6, '16:00:00', '17:30:00', 1),
(7, '18:00:00', '19:30:00', 1),
(8, '19:00:00', '20:30:00', 1),
(9, '07:00:00', '08:30:00', 6), -- HP - HN
(10, '08:00:00', '09:30:00', 6),
(11, '13:00:00', '14:30:00', 6),
(12, '14:00:00', '15:30:00', 6),
(13, '17:00:00', '18:30:00', 6),
(14, '18:00:00', '19:30:00', 6),
(15, '20:00:00', '21:30:00', 6),
(16, '21:00:00', '22:30:00', 6),
(17, '05:00:00', '07:00:00', 2), -- HN - QN
(18, '06:00:00', '08:00:00', 2),
(19, '13:00:00', '15:00:00', 2),
(20, '14:00:00', '16:00:00', 2),
(21, '8:30:00', '10:30:00', 7), -- QN - HN
(22, '09:30:00', '11:30:00', 7),
(23, '16:30:00', '18:30:00', 7),
(24, '17:30:00', '19:30:00', 7),
(25, '05:00:00', '12:00:00', 3), -- HN - NA
(26, '06:00:00', '13:00:00', 3),
(27, '14:00:00', '21:00:00', 8), -- NA - HN
(28, '15:00:00', '22:00:00', 8),
(29, '05:00:00', '11:00:00', 4), -- HN - LC
(30, '06:00:00', '12:00:00', 4),
(31, '13:00:00', '19:00:00', 9), -- LC - HN
(32, '14:00:00', '20:00:00', 9),
(33, '05:00:00', '08:00:00', 5), -- HN - TH
(34, '06:00:00', '09:00:00', 5),
(35, '13:00:00', '16:00:00', 5),
(36, '14:00:00', '17:00:00', 5),
(37, '08:30:00', '11:30:00', 10), -- TH - HN
(38, '09:30:00', '12:30:00', 10),
(39, '16:30:00', '19:30:00', 10),
(40, '17:30:00', '20:30:00', 10);


create table LichTrinh(
maKG int not null,
maXe varchar(100) not null,
primary key (maXe, maKG),
foreign key (maKG) references KhungGio(maKG),
foreign key (maXe) references Xe(maXe)
);
insert into LichTrinh (maKG, maXe) values
(1, 'X001'),
(2, 'X002'),
(3, 'X001'),
(4, 'X002'),
(5, 'X001'),
(6, 'X002'),
(7, 'X001'),
(8, 'X002'),
(9, 'X001'),
(10, 'X002'),
(11, 'X001'),
(12, 'X002'),
(13, 'X001'),
(14, 'X002'),
(15, 'X001'),
(16, 'X002'),

(17, 'X003'),
(18, 'X004'),
(19, 'X003'),
(20, 'X004'),
(21, 'X003'),
(22, 'X004'),
(23, 'X003'),
(24, 'X004'),

(25, 'X005'),
(26, 'X006'),
(27, 'X005'),
(28, 'X006'),

(29, 'X007'),
(30, 'X008'),
(31, 'X007'),
(32, 'X008'),

(33, 'X009'),
(34, 'X010'),
(35, 'X009'),
(36, 'X010'),
(37, 'X009'),
(38, 'X010'),
(39, 'X009'),
(40, 'X010');

create table ChoNgoi(
maCN int not null primary key,
giaTien decimal(8, 2) not null
);
insert into ChoNgoi (maCN, giaTien) values
(1, 150000),
(2, 150000),
(3, 150000),
(4, 150000),
(5, 150000),
(6, 150000),
(7, 150000),
(8, 150000),
(9, 150000),
(10, 150000),
(11, 150000),
(12, 150000),
(13, 150000),
(14, 150000),
(15, 150000),
(16, 150000),
(17, 150000),
(18, 150000),
(19, 150000),
(20, 150000),
(21, 150000),
(22, 150000),
(23, 150000),
(24, 150000),
(25, 150000),
(26, 150000),
(27, 150000),
(28, 150000);


create table XeChoNgoi(
maXe varchar(100) not null,
maCN int not null,
primary key(maXe, maCN),
foreign key(maXe) references xe(maXe),
foreign key(maCN) references chongoi(maCN)
);
INSERT INTO XeChoNgoi (maXe, maCN) VALUES
('X001', 1), ('X001', 2), ('X001', 3), ('X001', 4), ('X001', 5), ('X001', 6), ('X001', 7), ('X001', 8), ('X001', 9), ('X001', 10), 
('X001', 11), ('X001', 12), ('X001', 13), ('X001', 14), ('X001', 15), ('X001', 16), ('X001', 17), ('X001', 18), ('X001', 19), ('X001', 20),
('X001', 21), ('X001', 22), ('X001', 23), ('X001', 24), ('X001', 25), ('X001', 26), ('X001', 27), ('X001', 28),
('X002', 1), ('X002', 2), ('X002', 3), ('X002', 4), ('X002', 5), ('X002', 6), ('X002', 7), ('X002', 8), ('X002', 9), ('X002', 10), 
('X002', 11), ('X002', 12), ('X002', 13), ('X002', 14), ('X002', 15), ('X002', 16), ('X002', 17), ('X002', 18), ('X002', 19), ('X002', 20),
('X002', 21), ('X002', 22), ('X002', 23), ('X002', 24), ('X002', 25), ('X002', 26), ('X002', 27), ('X002', 28),
('X003', 1), ('X003', 2), ('X003', 3), ('X003', 4), ('X003', 5), ('X003', 6), ('X003', 7), ('X003', 8), ('X003', 9), ('X003', 10), 
('X003', 11), ('X003', 12), ('X003', 13), ('X003', 14), ('X003', 15), ('X003', 16), ('X003', 17), ('X003', 18), ('X003', 19), ('X003', 20),
('X003', 21), ('X003', 22), ('X003', 23), ('X003', 24), ('X003', 25), ('X003', 26), ('X003', 27), ('X003', 28),
('X004', 1), ('X004', 2), ('X004', 3), ('X004', 4), ('X004', 5), ('X004', 6), ('X004', 7), ('X004', 8), ('X004', 9), ('X004', 10), 
('X004', 11), ('X004', 12), ('X004', 13), ('X004', 14), ('X004', 15), ('X004', 16), ('X004', 17), ('X004', 18), ('X004', 19), ('X004', 20),
('X004', 21), ('X004', 22), ('X004', 23), ('X004', 24), ('X004', 25), ('X004', 26), ('X004', 27), ('X004', 28),
('X005', 1), ('X005', 2), ('X005', 3), ('X005', 4), ('X005', 5), ('X005', 6), ('X005', 7), ('X005', 8), ('X005', 9), ('X005', 10), 
('X005', 11), ('X005', 12), ('X005', 13), ('X005', 14), ('X005', 15), ('X005', 16), ('X005', 17), ('X005', 18), ('X005', 19), ('X005', 20),
('X005', 21), ('X005', 22), ('X005', 23), ('X005', 24), ('X005', 25), ('X005', 26), ('X005', 27), ('X005', 28),
('X006', 1), ('X006', 2), ('X006', 3), ('X006', 4), ('X006', 5), ('X006', 6), ('X006', 7), ('X006', 8), ('X006', 9), ('X006', 10),
('X007', 1), ('X007', 2), ('X007', 3), ('X007', 4), ('X007', 5), ('X007', 6), ('X007', 7), ('X007', 8), ('X007', 9), ('X007', 10),
('X007', 11), ('X007', 12), ('X007', 13), ('X007', 14), ('X007', 15), ('X007', 16), ('X007', 17), ('X007', 18), ('X007', 19), ('X007', 20),
('X007', 21), ('X007', 22), ('X007', 23), ('X007', 24), ('X007', 25), ('X007', 26), ('X007', 27), ('X007', 28),
('X008', 1), ('X008', 2), ('X008', 3), ('X008', 4), ('X008', 5), ('X008', 6), ('X008', 7), ('X008', 8), ('X008', 9), ('X008', 10),
('X008', 11), ('X008', 12), ('X008', 13), ('X008', 14), ('X008', 15), ('X008', 16), ('X008', 17), ('X008', 18), ('X008', 19), ('X008', 20),
('X008', 21), ('X008', 22), ('X008', 23), ('X008', 24), ('X008', 25), ('X008', 26), ('X008', 27), ('X008', 28),
('X009', 1), ('X009', 2), ('X009', 3), ('X009', 4), ('X009', 5), ('X009', 6), ('X009', 7), ('X009', 8), ('X009', 9), ('X009', 10),
('X009', 11), ('X009', 12), ('X009', 13), ('X009', 14), ('X009', 15), ('X009', 16), ('X009', 17), ('X009', 18), ('X009', 19), ('X009', 20),
('X009', 21), ('X009', 22), ('X009', 23), ('X009', 24), ('X009', 25), ('X009', 26), ('X009', 27), ('X009', 28),
('X010', 1), ('X010', 2), ('X010', 3), ('X010', 4), ('X010', 5), ('X010', 6), ('X010', 7), ('X010', 8), ('X010', 9), ('X010', 10),
('X010', 11), ('X010', 12), ('X010', 13), ('X010', 14), ('X010', 15), ('X010', 16), ('X010', 17), ('X010', 18), ('X010', 19), ('X010', 20),
('X010', 21), ('X010', 22), ('X010', 23), ('X010', 24), ('X010', 25), ('X010', 26), ('X010', 27), ('X010', 28);


create table KhachHang(
maKH varchar(100) not null primary key,
ten varchar(100) not null,
sdt varchar(10) not null,
email varchar(100)
);
INSERT INTO KhachHang (maKH, ten, sdt, email) VALUES
('KH001', 'Nguyen Thi Lan', '0901234567', 'lan.nguyen@example.com'),
('KH002', 'Tran Minh Duong', '0902345678', 'duong.tran@example.com'),
('KH003', 'Pham Thi Mai', '0903456789', 'mai.pham@example.com'),
('KH004', 'Le Thi Bich', '0904567890', 'bich.le@example.com'),
('KH005', 'Hoang Minh Tu', '0905678901', 'tu.hoang@example.com'),
('KH006', 'Tran Thi Phuong', '0906789012', 'tranthif@example.com'),
('KH007', 'Le Van Giang', '0907890123', 'levang@example.com'),
('KH008', 'Pham Thi Hong', '0908901234', 'phamthih@example.com'),
('KH009', 'Hoang Van Im', '0911234567', 'hoangvani@example.com'),
('KH010', 'Nguyen Thi Kien', '0912345678', 'nguyenthij@example.com'),
('KH011', 'Pham Van Khien', '0913456789', 'phamvank@example.com'),
('KH012', 'Tran Thi Linh', '0914567890', 'tranthil@example.com'),
('KH013', 'Nguyen Van Minh', '0915678901', 'nguyenvanm@example.com'),
('KH014', 'Le Thi Nam', '0916789012', 'lethin@example.com'),
('KH015', 'Hoang Van Ong', '0917890123', 'hoangvano@example.com'),
('KH016', 'Tran Thi Phung', '0918901234', 'tranthip@example.com'),
('KH017', 'Nguyen Van Quyen', '0921234567', 'nguyenvanq@example.com'),
('KH018', 'Tran Thi Rinh', '0922345678', 'tranthir@example.com'),
('KH019', 'Pham Van Son', '0923456789', 'phamvans@example.com'),
('KH020', 'Hoang Thi Thanh', '0924567890', 'hoangthit@example.com'),
('KH021', 'Nguyen Van Uyen', '0925678901', 'nguyenvanu@example.com'),
('KH022', 'Tran Thi Vinh', '0926789012', 'tranthiv@example.com'),
('KH023', 'Le Van Quynh', '0927890123', 'levanw@example.com'),
('KH024', 'Pham Thi Xuan', '0928901234', 'phamthix@example.com');

create table KhachHangTuyenXe(
maKH varchar(100) not null,
maXe varchar(100) not null,
maCN int not null,
ngayDi date not null,
gioDi time not null,
maTD int not null,
primary key(maKH, maXe, maCN, ngayDi, gioDi),
foreign key (maKH) references khachhang(maKH),
foreign key (maXe) references xe(maXe),
foreign key (maCN) references chongoi(maCN)
);

INSERT INTO KhachHangTuyenXe (maKH, maXe, maCN, ngayDi, gioDi, maTD) VALUES
('KH006', 'X002', 6, '2024-11-30', '16:00:00', 1),
('KH007', 'X001', 7, '2024-12-01', '18:00:00', 1),
('KH008', 'X002', 8, '2024-12-02', '19:00:00', 1),

('KH014', 'X004', 14, '2024-11-30', '09:30:00', 7),
('KH015', 'X003', 15, '2024-12-01', '16:30:00', 7),
('KH016', 'X004', 16, '2024-12-02', '17:30:00', 7),

('KH023', 'X007', 23, '2024-12-01', '13:00:00', 9),
('KH024', 'X008', 24, '2024-12-02', '14:00:00', 9),

('KH022', 'X008', 20, '2024-12-01', '06:00:00', 4),
('KH022', 'X008', 18, '2024-12-01', '06:00:00', 4),
('KH022', 'X008', 19, '2024-12-01', '06:00:00', 4),
('KH022', 'X008', 22, '2024-12-01', '06:00:00', 4),

('KH023', 'X001', 1, '2024-12-01', '05:00:00', 1),
('KH023', 'X001', 2, '2024-12-01', '05:00:00', 1),
('KH023', 'X001', 3, '2024-12-01', '05:00:00', 1),
('KH023', 'X001', 4, '2024-12-01', '05:00:00', 1),
('KH023', 'X001', 5, '2024-12-01', '05:00:00', 1),

('KH021', 'X002', 1, '2024-12-01', '06:00:00', 1),
('KH021', 'X002', 2, '2024-12-01', '06:00:00', 1),
('KH021', 'X002', 3, '2024-12-01', '06:00:00', 1),
('KH021', 'X002', 4, '2024-12-01', '06:00:00', 1),
('KH021', 'X002', 5, '2024-12-01', '06:00:00', 1),

('KH016', 'X001', 1, '2024-12-01', '07:00:00', 6),
('KH016', 'X001', 2, '2024-12-01', '07:00:00', 6),
('KH016', 'X001', 3, '2024-12-01', '07:00:00', 6),
('KH016', 'X001', 4, '2024-12-01', '07:00:00', 6),
('KH016', 'X001', 5, '2024-12-01', '07:00:00', 6),

('KH015', 'X002', 4, '2024-12-01', '08:00:00', 6),
('KH015', 'X002', 5, '2024-12-01', '08:00:00', 6),
('KH015', 'X002', 6, '2024-12-01', '08:00:00', 6),
('KH015', 'X002', 7, '2024-12-01', '08:00:00', 6),
('KH015', 'X002', 8, '2024-12-01', '08:00:00', 6),

('KH017', 'X003', 1, '2024-12-01', '05:00:00', 2),
('KH017', 'X003', 2, '2024-12-01', '05:00:00', 2),
('KH017', 'X003', 3, '2024-12-01', '05:00:00', 2),
('KH017', 'X003', 4, '2024-12-01', '05:00:00', 2),

('KH019', 'X004', 9, '2024-12-01', '06:00:00', 2),
('KH019', 'X004', 10, '2024-12-01', '06:00:00', 2),
('KH019', 'X004', 11, '2024-12-01', '06:00:00', 2),
('KH019', 'X004', 12, '2024-12-01', '06:00:00', 2),

('KH010', 'X003', 13, '2024-12-01', '08:30:00', 7),
('KH010', 'X003', 14, '2024-12-01', '08:30:00', 7),
('KH010', 'X003', 15, '2024-12-01', '08:30:00', 7),
('KH010', 'X003', 16, '2024-12-01', '08:30:00', 7),

('KH012', 'X004', 1, '2024-12-01', '09:30:00', 7),
('KH012', 'X004', 2, '2024-12-01', '09:30:00', 7),
('KH012', 'X004', 5, '2024-12-01', '09:30:00', 7),
('KH012', 'X004', 7, '2024-12-01', '09:30:00', 7),

('KH004', 'X005', 1, '2024-12-01', '05:00:00', 3),
('KH004', 'X005', 2, '2024-12-01', '05:00:00', 3),
('KH004', 'X005', 5, '2024-12-01', '05:00:00', 3),
('KH004', 'X005', 7, '2024-12-01', '05:00:00', 3),

('KH006', 'X005', 1, '2024-12-01', '14:00:00', 8),
('KH006', 'X005', 2, '2024-12-01', '14:00:00', 8),
('KH006', 'X005', 5, '2024-12-01', '14:00:00', 8),
('KH006', 'X005', 7, '2024-12-01', '14:00:00', 8),

('KH020', 'X007', 1, '2024-12-01', '05:00:00', 4),
('KH020', 'X007', 2, '2024-12-01', '05:00:00', 4),
('KH020', 'X007', 3, '2024-12-01', '05:00:00', 4),
('KH020', 'X007', 4, '2024-12-01', '05:00:00', 4),

('KH011', 'X007', 1, '2024-12-01', '13:00:00', 9),
('KH011', 'X007', 2, '2024-12-01', '13:00:00', 9),
('KH011', 'X007', 3, '2024-12-01', '13:00:00', 9),
('KH011', 'X007', 4, '2024-12-01', '13:00:00', 9),

('KH008', 'X009', 1, '2024-12-01', '05:00:00', 5),
('KH008', 'X009', 2, '2024-12-01', '05:00:00', 5),
('KH008', 'X009', 3, '2024-12-01', '05:00:00', 5),
('KH008', 'X009', 4, '2024-12-01', '05:00:00', 5),

('KH009', 'X009', 1, '2024-12-01', '13:00:00', 5),
('KH009', 'X009', 2, '2024-12-01', '13:00:00', 5),
('KH009', 'X009', 3, '2024-12-01', '13:00:00', 5),
('KH009', 'X009', 4, '2024-12-01', '13:00:00', 5),

('KH001', 'X010', 1, '2024-12-01', '09:30:00', 10),
('KH001', 'X010', 2, '2024-12-01', '09:30:00', 10),
('KH001', 'X010', 3, '2024-12-01', '09:30:00', 10),
('KH001', 'X010', 4, '2024-12-01', '09:30:00', 10);

create table Ve(
maVe varchar(255) not null primary key,
maKH varchar(100) not null,
maXe varchar(100) not null,
maTD int not null,
ngayDi date not null,
gioDi time not null,
phuongThucThanhToan varchar(255) not null,
tongTien decimal(10,2) not null,
trangThai enum('Đã thanh toán', 'Chưa thanh toán', 'Đã hủy', 'Đang chờ xử lý') not null,
foreign key(maKH) references KhachHang(maKH)
);

create table Tam_ThongTinDatVe(
maKH varchar(100) not null primary key,
maXe varchar(100) not null,
ten varchar(100) not null,
sdt varchar(10) not null,
email varchar(100),
diemDi varchar(100) not null,
diemDen varchar(100) not null,
ngayDi date not null,
gioDi time not null,
tongTien decimal(10,2) not null
);

create table Tam_KhachHangChoNgoi(
maKH varchar(100) not null,
maXe varchar(100) not null,
maCN int not null,
ngayDi date not null,
gioDi time not null,
primary key(maKH, maXe, maCN, ngayDi, gioDi)
);